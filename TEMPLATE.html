<!doctype html>
<html>
<head>
	<title>Machen Example</title>
	<link href="stylesheet.css" type="text/css" rel="stylesheet" />
</head>
<body>
	<div id="page_number">Page 1</div>
	<div id="navigation"> <a href="javascript:void(0);">&lt;&lt; back</a>  |  <a href="javascript:void(0);">Next &gt;&gt;</a> </div>
	<div id="header">
		Machen Example
	</div>
	<div id="content" class="no-select" onselectstart="return false;">
		<div class="machen-panel" >
			<div style="text-align: center;">
				<h1>Welcome to Machen</h1>
				<p>A simple tool that works like presentation software (think PowerPoint.) with the intent of 
				   being a revision tool. The idea is that questions would show and you can click the space or 
				   enter key (or arrows, or click with the mouse) to show the answer, then press again to go to 
				   the next slide. You can click the backspace button to go back a slide and press "f" to go into full browser window mode; i.e. to remove the top and bottom bars</p>
			</div>
		</div>
		<div class="machen-panel">
			<h2>Question 1</h2>
			<p>What is PI to the first 5 decimal places</p>
			<div class="machen-answer">3.14159</div>
		</div>
		<div class="machen-panel">
			<h2>Question 2</h2>
			<p>What is the Square root of 144</p>
			<div class="machen-answer">12</div>
		</div>
	</div>
	<div id="footer">
		<div id="copyright">Copyright (c) 2011 Justin Wishart</div>
	</div>
	
	<script src="jquery.js"></script>
	<script src="machen.js"></script>
	<script type="text/javascript">
		function setupViewport(fullScreenMode) {
			if (undefined == fullScreenMode)
				fullScreenMode = false;
				
			var header = $("#header");
			var content = $("#content");
			var footer = $("#footer");
			var pageNumber = $("#page_number");
			var navigation = $("#navigation");
			
			if (true == fullScreenMode) {
				header.slideUp();
				footer.slideUp();
				pageNumber.slideUp();
				navigation.slideUp();
			} else {
				header.fadeIn();
				footer.fadeIn();
				pageNumber.fadeIn();
				navigation.fadeIn();
			}
			
			// Calculate the height of the content area
			var totalHeight = $(window).height();
			
			if (false == fullScreenMode) {
				totalHeight -= header.outerHeight(true);
				totalHeight -= footer.outerHeight(true);
			}
			
			totalHeight -= parseInt(content.css("padding-top").replace("px", ""))
							 + parseInt(content.css("padding-bottom").replace("px", ""));
							 
			content.height(totalHeight);

			// Calcultae the width of the content area
			var totalWidth = $(window).width();
			totalWidth -= parseInt(content.css("padding-left").replace("px", ""))
			             + parseInt(content.css("padding-right").replace("px", ""));
			content.width(totalWidth);
		}
		
		$(document).ready(function() {
			var header = $("#header");
			var content = $("#content");
			var footer = $("#footer");
			var pageNumber = $("#page_number");
			var navigation = $("#navigation");
		
			setupViewport();
			
			// Setup event handler to keep our nice viewport stuff going on resize
			$(window).resize(function() {
				machen.setupViewport();
			});
			
			content.machen({
				slideClass:'machen-panel',
				slideChange: function(current, next) {
					var currentPanel = content.machen("getSlide", current);
					var answers = currentPanel.find(".machen-answer");
					
					if (answers.length == 1) {
						if (false == $(answers.get(0)).is(":visible")) {
							$(answers.get(0)).show();
							return false;
						}
					}
					
					pageNumber.html("Page " + parseInt(next + 1));
					
					if (next > current) {
						currentPanel.next().find(".machen-answer").hide();
					}
					
					return true;
				}
			});		
			
			content.click(function() {
				content.machen("next");
			});
			
			navigation.fadeTo("fast", 0.25);
			navigation.hover(function(){
				navigation.fadeTo("slow", 1);
			}, function() { 
				navigation.fadeTo("slow", 0.25);
			});
			
			footer.fadeTo("fast", 0.25);
			footer.hover(function() {
				footer.fadeTo("slow", 1);
			}, function() {
				footer.fadeTo("slow", 0.25);
			});
			
			// NOTE: Have to use keydown event as chrome doesn't capture backspace
			$(window.document).keydown(function(event) {
				//alert(event.which);
				
				// 32 is the space key; 13 is the enter key; 39 is the right arrow key
				if ('32' == event.which || '13' == event.which || '39' == event.which ) {
					event.preventDefault();
					content.machen("next");
				}
				
				// 8 is the backspace key - 37 is left arrow key
				if ('8' == event.which || '37' == event.which) {
					event.preventDefault();
					content.machen("prev");
				}
				
				// Alternate from full screen mode and normal mode
				if ('70' == event.which) {
					setupViewport(header.is(":visible"));
				}
			});
			
			// Setup navigation links
			var navAnchors = navigation.find("a");
			navAnchors.first().click(function(e) {
				e.preventDefault();
				content.machen("prev");
			});
			
			navAnchors.last().click(function(e) {
				e.preventDefault();
				content.machen("next");
			});
			
			setupViewport();
		});
	</script>
</body>
</html>